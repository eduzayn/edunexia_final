com base no seu reposit√≥rio e na captura de tela com o erro ao adicionar v√≠deo-aula, aqui est√° a explica√ß√£o t√©cnica do problema e como resolv√™-lo de forma definitiva para todas as fontes de v√≠deo (YouTube, Google Drive, etc.).

üß® Erro: ‚ÄúResposta do servidor n√£o est√° no formato JSON‚Äù
üîç Diagn√≥stico:
O frontend espera que a resposta do backend seja um JSON, mas est√° recebendo um conte√∫do em HTML ‚Äî provavelmente uma p√°gina de erro 404 ou 500 do Vercel ou do Express.

Isso acontece quando:

A rota POST para adicionar o v√≠deo n√£o existe no backend

Ou a rota existe, mas n√£o retorna um res.json() corretamente

Ou h√° um erro n√£o tratado que faz o Express retornar uma p√°gina HTML gen√©rica de erro

‚úÖ Como resolver
1. Confirme a exist√™ncia da rota no backend
Verifique se voc√™ tem algo assim em server/routes/discipline.ts ou server/routes/video.ts:

ts
Copiar
Editar
router.post("/api/disciplines/:id/videos", async (req, res) => {
  try {
    const { id } = req.params;
    const { title, description, videoSource, url, duration } = req.body;

    // Fa√ßa a inser√ß√£o no banco aqui (com Drizzle ou outro ORM)

    return res.status(200).json({ success: true, message: "V√≠deo adicionado com sucesso." });
  } catch (err) {
    console.error(err);
    return res.status(500).json({ success: false, message: "Erro ao adicionar v√≠deo." });
  }
});
‚úÖ Certifique-se de que est√° retornando sempre um res.json() ‚Äî e nunca deixando cair em erro sem tratamento.

2. Garanta que essa rota foi registrada corretamente
No server/index.ts ou server/routes.ts, verifique:

ts
Copiar
Editar
import videoRoutes from "./routes/video";

app.use(videoRoutes); // ‚úÖ isso √© obrigat√≥rio
3. Corrija a URL de chamada no frontend
No componente que salva a videoaula (provavelmente algo como discipline-content-page.tsx), garanta que a chamada fetch() aponte para:

ts
Copiar
Editar
/api/disciplines/:id/videos
e que esteja enviando corretamente um JSON:

ts
Copiar
Editar
fetch(apiUrl(`/disciplines/${id}/videos`), {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    title,
    description,
    url,
    videoSource,
    duration
  })
});
