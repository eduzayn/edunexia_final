<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    
    <!-- Detector de navegador e carregador de patch -->
    <script>
      (function() {
        // Detectar se este navegador precisa do patch
        function isBrowserWithIssues() {
          if (typeof navigator === 'undefined') return false;
          
          const userAgent = navigator.userAgent.toLowerCase();
          
          // Chrome em Windows - problemas conhecidos
          const isChrome = userAgent.indexOf('chrome') > -1 && userAgent.indexOf('safari') > -1;
          const isWindows = userAgent.indexOf('windows') > -1;
          const problematicChrome = isChrome && isWindows;
          
          // Edge baseado em Chromium
          const isEdge = userAgent.indexOf('edg/') > -1;
          const problematicEdge = isEdge && isWindows;
          
          // Chrome no iOS
          const isChromeIOS = userAgent.indexOf('crios') > -1;
          
          // Samsung Internet Browser
          const isSamsungBrowser = userAgent.indexOf('samsungbrowser') > -1;
          
          // Navegadores seguros conhecidos
          const isFirefox = userAgent.indexOf('firefox') > -1;
          const isSafari = userAgent.indexOf('safari') > -1 && !isChrome;
          
          // Se for navegador conhecido como seguro, não precisa do patch
          if (isFirefox || isSafari) {
            console.log('✓ [Browser Detector] Navegador estável detectado, não precisa de patch');
            return false;
          }
          
          return problematicChrome || problematicEdge || isChromeIOS || isSamsungBrowser;
        }
        
        // Carregar script de patch apenas para navegadores com problemas
        if (isBrowserWithIssues()) {
          console.log('⚠️ [Browser Detector] Navegador com problemas conhecidos detectado, carregando patch...');
          
          // Criar elemento de script
          const script = document.createElement('script');
          script.src = '/browser-patch.js'; // Localizado na pasta public
          script.id = 'browser-compatibility-patch';
          
          // Anexar ao cabeçalho para carregamento imediato
          document.head.appendChild(script);
          
          // Adicionar flag para aplicação saber que está no modo de compatibilidade
          window.BROWSER_COMPATIBILITY_MODE = true;
          
          console.log('✅ [Browser Detector] Patch de compatibilidade carregado com sucesso');
        } else {
          console.log('✓ [Browser Detector] Navegador compatível, não é necessário patch');
          window.BROWSER_COMPATIBILITY_MODE = false;
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>